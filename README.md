# Сервис для вычисления арифметических выражений

Веб-сервис с одним эндпоинтом, на который можно отправить POST-запрос с арифметическим выражением и получить в ответ его результат.

## Функциональность

- Вычисление арифметических выражений, переданных пользователем.
- Обработка некорректных данных, в этом случае возвращаются соответствующие сообщения об ошибках

## API

### Эндпоинт: `/api/v1/calculate`

**Method:** `POST`  
**Content-Type:** `application/json`   
**Body:**
```json
{
    "expression": "выражение, которое ввёл пользователь"
}
```

#### Успешный ответ (HTTP 200)
```json
{
    "result": "результат выражения"
}
```
#### Некорректное выражение (HTTP 422)
Возвращается, если выражение содержит недопустимые символы (например, буквы) или имеет некорректный формат (незакрытая скобка, деление на 0).
```json
{
    "error": "Expression is not valid"
}
```
#### Внутренняя ошибка сервера (HTTP 500)
Возвращается, если при обработке запроса произошла неожиданная ошибка.
```json
{
    "error": "Internal server error"
}
```
## Примеры использования
### Postman
Создаем новый запрос, в поле адреса выбираем метод POST и прописываем адрес `http://localhost:8080/api/v1/calculate`. На вкладке Body выбираем формат raw и добавляем желаемое выражение.

#### Успешное выражение
```json
{
  "expression": "2+2*2"
}
```
Ответ:
```json
{
    "result": "6"
}
```
#### Некорректное выражение (HTTP 422)
```json
{
    "expression": "2+2*2a"
}
```
Ответ:
```json
{
    "error": "Expression is not valid"
}
```
### Отладка через CURL
Открываем терминал cmd или PowerShell (документация ниже на примере Windows), пишем запросы следующего вида и смотрим на ответы:
| Выражение  | Запрос | Ответ | Код
| ---------------------| ------------------------- | ------------------|----|
| (2+2)*2  | `curl -X POST -H "Content-Type:application/json" -d "{\"expression\":\"(2+2)*2\"}" http://localhost:8080/api/v1/calculate`  | 	`result: 8.000000`    | 200 |
| -(2+2)*(-4)  | `curl -X POST -H "Content-Type:application/json" -d "{\"expression\":\"-(2+2)*(-4)\"}" http://localhost:8080/api/v1/calculate`  | 	`result: 16.000000`    | 200 |
| -2/4 | `curl -X POST -H "Content-Type:application/json" -d "{\"expression\":\"-2/4\"}" http://localhost:8080/api/v1/calculate` | `result: -0.500000` | 200 |
| 10 / 0 | `curl -X POST -H "Content-Type:application/json" -d "{\"expression\":\"10/0\"}" http://localhost:8080/api/v1/calculate`  | `error: division by zero` | 422 |
| 2+2*2a  | `curl -X POST -H "Content-Type:application/json" -d "{\"expression\":\"2+2*2a\"}" http://localhost:8080/api/v1/calculate`  | `error: unknown symbol` | 422 |
| 12++3  | `curl -X POST -H "Content-Type:application/json" -d "{\"expression\":\"12++3\"}" http://localhost:8080/api/v1/calculate`  | `error: incorrect expression` | 422 |

## Инструкция по запуску
1. Клонируйте репозиторий:
```bash
git clone https://github.com/kleo-53/web_calc_go.git
cd web_calc_go
```
2. Запустите сервис из терминала:
```bash
go run .\cmd\main.go
```
По умолчанию используется порт 8080, но в качестве аргументов можно передать другой:
```bash
$env:PORT=8888; go run .\cmd\main.go
```

3. Сервис будет доступен по адресу ```http://localhost:8080``` (или по выбранному вами порту). 

4. Для взаимодействия с сервисом можно использовать Postman или отправлять запросы через curl.
## Тестирование
Проект оснащен тестами для функций:
* вычисления арифметических выражений - распознавание деления на ноль, незакрытых скобок, букв вместо цифр и т.д.
* хендлера - проверяется отправка корректных кодов ошибок в соответствии с переданными выражениями

Для запуска всех тестов выполните в терминале из корневой папки проекта команду: 
```bash
go test ./...
```